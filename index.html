<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DATAPLUS GH</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js"></script>

<style>
:root{
  --bg:#020617;--card:rgba(15,23,42,.85);
  --border:rgba(255,255,255,.08);--text:#f8fafc;
  --accent:#38bdf8;
}
.light{
  --bg:#f8fafc;--card:#fff;
  --border:rgba(0,0,0,.1);--text:#020617;
  --accent:#2563eb;
}
*{box-sizing:border-box}
body{
  margin:0;font-family:'Space Grotesk',sans-serif;
  background:radial-gradient(circle at top,#0f172a,var(--bg));
  color:var(--text);
}
header{
  padding:20px;display:flex;justify-content:space-between;align-items:center;
}
button{
  background:linear-gradient(135deg,var(--accent),#6366f1);
  border:none;padding:10px 16px;border-radius:14px;
  font-weight:700;cursor:pointer;
}
.container{max-width:1000px;margin:auto;padding:20px;}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px;padding:22px;margin-bottom:18px;
}
.price{color:var(--accent);font-size:20px;font-weight:700}
input,select{
  width:100%;padding:12px;border-radius:12px;
  border:1px solid var(--border);
  background:transparent;color:var(--text);
  margin-bottom:10px;
}
#ad{border:1px dashed var(--accent);text-align:center}
#announcement{
  display:none;padding:12px;text-align:center;
  background:linear-gradient(90deg,#38bdf8,#6366f1);
  color:#020617;font-weight:700;
}
footer{
  margin-top:60px;padding:40px 20px;
  background:rgba(0,0,0,.3);
}
.whatsapp{
  position:fixed;right:20px;bottom:20px;
  background:#25d366;color:#fff;
  padding:14px 20px;border-radius:999px;
  font-weight:800;text-decoration:none;
}
</style>
</head>

<body>

<div id="announcement"></div>

<header>
  <strong>DATAPLUS GH</strong>
  <button onclick="toggleTheme()">üåì</button>
</header>

<div class="container">
  <div id="products"></div>
  <div id="admin"></div>
</div>

<div class="container">
  <div class="card" id="ad">
    <h3>üöÄ Website Development</h3>
    <p><strong>WANT CUSTOM WEBSITES JUST LIKE THIS FOR YOUR BUSINESS?</strong></p>
    <p class="price">GET ONE FOR AS LOW AS GHC 180 ONLY</p>
    <a href="https://wa.me/233554222103" target="_blank">
      <button>Chat on WhatsApp</button>
    </a>
  </div>
</div>

<footer>
  <div class="container">
    <h3>KAYSAM GROWTH</h3>
    <p>üìû 0554222103 / 0532942413</p>
    <p>üìß kaysamgrowth@gmail.com</p>
    <p>üìç Near the All Nations University, Koforidua</p>
    <p style="font-size:12px;">¬© <span id="year"></span></p>
  </div>
</footer>

<a class="whatsapp"
 href="https://whatsapp.com/channel/0029VbBxGK6KrWR2RGMUlm1Z"
 target="_blank">Join WhatsApp</a>

<script>
year.textContent=new Date().getFullYear();

/* FIREBASE */
firebase.initializeApp({
  apiKey:"AIzaSyCs7lN4itvWZPichtFLdEE4swNQHSX_j1M",
  authDomain:"dataplus-a93c7.firebaseapp.com",
  projectId:"dataplus-a93c7",
  storageBucket:"dataplus-a93c7.appspot.com",
  messagingSenderId:"1040979049946",
  appId:"1:1040979049946:web:d5d7957a6c209f56dd94e3"
});
const auth=firebase.auth();
const db=firebase.firestore();

const ADMIN_UID="ANwgaBBGe2fLyom7yzujdzQAY1k1";
let isAdmin=false;

/* THEME */
if(localStorage.theme==="light")document.body.classList.add("light");
function toggleTheme(){
  document.body.classList.toggle("light");
  localStorage.theme=document.body.classList.contains("light")?"light":"dark";
}

/* AUTH */
auth.onAuthStateChanged(async user=>{
  if(user){
    isAdmin=user.uid===ADMIN_UID;
    loadProducts();
  }else{
    await auth.signInAnonymously();
  }
});

/* ANNOUNCEMENT */
db.collection("config").doc("app").onSnapshot(d=>{
  if(!d.exists)return;
  announcement.style.display=d.data().announcementActive?"block":"none";
  announcement.textContent=d.data().announcementText||"";
});

/* PRODUCTS */
async function loadProducts(){
  const snap=await db.collection("products").where("active","==",true).get();
  let html="";
  snap.forEach(doc=>{
    const p=doc.data();
    html+=`
    <div class="card">
      <h3>${p.name}</h3>
      <div class="price">GHS ${p.price}</div>
      ${
        p.category==="physical"
        ? `<a href="${p.buyLink}" target="_blank"><button>Buy Item</button></a>`
        : `<button onclick="order('${doc.id}','${p.name}',${p.price})">Buy Data</button>`
      }
    </div>`;
  });
  products.innerHTML=html;
  admin.innerHTML=isAdmin?adminPanel():"";
}

/* ORDER */
function order(id,name,price){
  const phone=prompt("Enter phone number");
  const ref=prompt("Enter MoMo reference");
  if(!phone||!ref)return;
  db.collection("orders").add({
    productId:id,productName:name,price,
    phone,momoRef:ref,status:"Pending Approval",
    createdAt:firebase.firestore.FieldValue.serverTimestamp()
  });
  alert("Order submitted");
}

/* ADMIN PANEL */
function adminPanel(){
  return`
  <div class="card">
    <h3>üõ† Admin Panel</h3>
    <input id="pname" placeholder="Product name">
    <input id="pprice" type="number" placeholder="Price">
    <select id="pcat">
      <option value="data">Data</option>
      <option value="physical">Physical</option>
    </select>
    <input id="plink" placeholder="Buy link">
    <button onclick="addProduct()">Add Product</button>
    <hr>
    <button onclick="loadOrders()">View Orders</button>
    <div id="orders"></div>
  </div>`;
}

function addProduct(){
  db.collection("products").add({
    name:pname.value,
    price:Number(pprice.value),
    category:pcat.value,
    buyLink:plink.value||"",
    active:true,
    createdAt:firebase.firestore.FieldValue.serverTimestamp()
  });
  loadProducts();
}

async function loadOrders(){
  const snap=await db.collection("orders").orderBy("createdAt","desc").get();
  orders.innerHTML=snap.docs.map(d=>{
    const o=d.data();
    return`
    <div class="card">
      <b>${o.productName}</b>
      <p>${o.phone}</p>
      <p>${o.status}</p>
      <button onclick="approve('${d.id}')">Approve</button>
    </div>`;
  }).join("");
}

function approve(id){
  db.collection("orders").doc(id).update({status:"Approved"});
  loadOrders();
}
</script>
</body>
  </html>
